(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[284],{1244:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/scan",function(){return n(34)}])},468:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5893),i=n(1599),a=n.n(i);function o(){return(0,r.jsx)("div",{className:a().container})}},7649:function(e,t,n){"use strict";n.d(t,{_g:function(){return a},e1:function(){return i},oo:function(){return o}});var r=n(9353);let i=()=>{let e="https://raw.githubusercontent.com/justadudewhohacks/face-api.js/master/weights/";return Promise.all([r.nets.tinyFaceDetector.loadFromUri(e+"tiny_face_detector_model-weights_manifest.json"),r.nets.faceLandmark68Net.loadFromUri(e+"face_landmark_68_model-weights_manifest.json"),r.nets.faceRecognitionNet.loadFromUri(e+"face_recognition_model-weights_manifest.json"),r.nets.faceExpressionNet.loadFromUri(e+"face_expression_model-weights_manifest.json")])},a=async e=>{if(!e)return;let t=null==e?void 0:e.getBoundingClientRect(),n={width:null==t?void 0:t.width,height:null==t?void 0:t.height};if(0===n.height)return;let i=await r.detectAllFaces(e,new r.TinyFaceDetectorOptions({inputSize:320})).withFaceLandmarks().withFaceExpressions();return r.resizeResults(i,n)},o=async(e,t,n,i)=>{if(e&&t&&n){var a,o,s,c,d;let l=e.getBoundingClientRect(),u={width:null==l?void 0:l.width,height:null==l?void 0:l.height};r.matchDimensions(t,u),null===(a=null==t?void 0:t.getContext("2d"))||void 0===a||a.clearRect(0,0,null==t?void 0:t.width,null==t?void 0:t.height);let h=null==r?void 0:r.resizeResults(n,u);switch(i){case"landmarks":r.draw.drawFaceLandmarks(t,h);break;case"expressions":r.draw.drawFaceExpressions(t,h);break;case"box":null==r||null===(o=r.draw)||void 0===o||o.drawDetections(t,h);break;case"boxLandmarks":null==r||null===(s=r.draw)||void 0===s||s.drawDetections(t,h),null==r||null===(c=r.draw)||void 0===c||c.drawFaceExpressions(t,h),null==r||null===(d=r.draw)||void 0===d||d.drawFaceLandmarks(t,h);break;case"error":console.log("error");default:throw Error("Invalid type")}}}},34:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var r=n(5893),i=n(4443),a=n.n(i),o=n(9008),s=n.n(o),c=n(580),d=n.n(c),l=n(468),u=n(5440),h=n.n(u),f=n(7294),m=n(7649),p=n(4970),v=n.n(p),_=n(1346),g=n.n(_);function w(e){let{isSucess:t}=e,[n,i]=(0,f.useState)(!1),a=(0,f.useRef)(),o=(0,f.useRef)(),[s,c]=(0,f.useState)([]);(0,f.useEffect)(()=>{i(!0)},[]);let d=async()=>{if(null!==a.current){var e,t;let n=await (0,m._g)(null===(e=a.current)||void 0===e?void 0:e.video);await (0,m.oo)(null===(t=a.current)||void 0===t?void 0:t.video,o.current,n,"boxLandmarks"),c(n)}},u=e=>{var t;null===(t=e.current)||void 0===t||t.getContext("2d").clearRect(0,0,e.width,e.height)};return(0,f.useEffect)(()=>{null!==o.current&&console.log(o)},[]),(0,f.useEffect)(()=>{if(null===a||!0!=n)return u(o);{let e=setInterval(async()=>{await d()},80);return()=>{u(o),clearInterval(e)}}},[n]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"".concat(g().camera," ").concat(h().className),children:[(0,r.jsxs)("div",{className:g().camera__wrapper,children:[(0,r.jsx)(v(),{audio:!1,ref:a,width:"100%",height:"auto"}),(0,r.jsx)("canvas",{className:"".concat(g().webcamoverlay," ").concat(h().className),ref:o,style:{zIndex:99}})]}),(null==s?void 0:s.length)>0?s.map((e,n)=>{setTimeout(()=>{var n;t(Object.keys(n=e.expressions).reduce(function(e,t){return n[e]>n[t]?e:t}))},3e3)}):(0,r.jsx)(l.Z,{})]})})}var y=n(1163);function S(){let e=(0,y.useRouter)(),[t,n]=(0,f.useState)(!0),[i,o]=(0,f.useState)(""),c=e=>{""!=e&&void 0!=e&&null!=e&&(o(e),console.log(i))};return(0,f.useEffect)(()=>{(0,m.e1)(),navigator.permissions.query({name:"camera"}).then(e=>{"granted"==e.state&&setTimeout(()=>{n(!1)},5e3)})},[]),(0,f.useEffect)(()=>{""!=i&&(sessionStorage.setItem("emotion",i),""!=i&&void 0!=i&&null!=i&&e.push("/explore"))},[i,e]),(0,r.jsxs)("div",{className:d().container,children:[(0,r.jsxs)(s(),{children:[(0,r.jsx)("title",{children:"BINGE"}),(0,r.jsx)("meta",{name:"description",content:"BINGE | SCAN"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("link",{rel:"icon",href:"https://img.icons8.com/color/48/null/spyro.png"})]}),(0,r.jsx)("main",{className:d().main,children:t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{}),(0,r.jsx)("p",{className:"".concat(d().title," ").concat(a().className),children:"Make sure you allow camera access!"}),(0,r.jsx)("p",{className:"".concat(d().desc," ").concat(a().className),children:"After allowing camera access, Please wait for 5-10 seconds!"})]}):(0,r.jsxs)("div",{className:d().widget,children:[(0,r.jsx)("p",{className:"".concat(d().title," ").concat(a().className),children:"\uD83D\uDE01 Say cheese!"}),(0,r.jsx)("p",{className:"".concat(d().desc," ").concat(a().className),children:"Identifying your facial gestures, Hold it there!"}),(0,r.jsx)(w,{isSucess:c})]})})]})}},5440:function(e){e.exports={style:{fontFamily:"'__Open_Sans_d8c39e', '__Open_Sans_Fallback_d8c39e'",fontStyle:"normal"},className:"__className_d8c39e"}},4443:function(e){e.exports={style:{fontFamily:"'__Open_Sans_d8c39e', '__Open_Sans_Fallback_d8c39e'",fontStyle:"normal"},className:"__className_d8c39e"}},1346:function(e){e.exports={camera:"FaceTest_camera__0F1Q_",scroll_down:"FaceTest_scroll_down__MqKYe",camera__wrapper:"FaceTest_camera__wrapper__Jwd7u","camera__button-container":"FaceTest_camera__button-container__nTbWJ","camera__button--snap":"FaceTest_camera__button--snap__LL1ts",webcamoverlay:"FaceTest_webcamoverlay___HtQL",webcamoverlayhidden:"FaceTest_webcamoverlayhidden__Cr61h",results__container:"FaceTest_results__container__3IevW",results__wrapper:"FaceTest_results__wrapper__gyMK0"}},580:function(e){e.exports={container:"Scan_container__eCkJ5",main:"Scan_main__HF1V1",title:"Scan_title__Kbh5L",desc:"Scan_desc__xb0vM",widget:"Scan_widget___vdnf"}},1599:function(e){e.exports={container:"Spinner_container__hrwqx",spin:"Spinner_spin__tiwVl"}},4970:function(e,t,n){var r;e.exports=(r=n(7294),function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,(function(t){return e[t]}).bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(e,t,n){"use strict";n.r(t);var r,i=n(/*! react */"react"),a=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function c(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}"undefined"!=typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise(function(n,r){t.call(navigator,e,n,r)}):Promise.reject(Error("getUserMedia is not implemented in this browser"))}));var d=function(e){function t(t){var n=e.call(this,t)||this;return n.canvas=null,n.ctx=null,n.requestUserMediaId=0,n.unmounted=!1,n.state={hasUserMedia:!1},n}return a(t,e),t.prototype.componentDidMount=function(){var e=this.state,t=this.props;if(this.unmounted=!1,!c()){t.onUserMediaError("getUserMedia not supported");return}e.hasUserMedia||this.requestUserMedia(),t.children&&"function"!=typeof t.children&&console.warn("children must be a function")},t.prototype.componentDidUpdate=function(e){var t=this.props;if(!c()){t.onUserMediaError("getUserMedia not supported");return}var n=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),r=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),i=e.minScreenshotWidth!==t.minScreenshotWidth,a=e.minScreenshotHeight!==t.minScreenshotHeight;(r||i||a)&&(this.canvas=null,this.ctx=null),(n||r)&&(this.stopAndCleanup(),this.requestUserMedia())},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},t.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map(function(t){e.removeTrack(t),t.stop()}),e.getAudioTracks().map(function(t){e.removeTrack(t),t.stop()})):e.stop())},t.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(t.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},t.prototype.getScreenshot=function(e){var t=this.state,n=this.props;if(!t.hasUserMedia)return null;var r=this.getCanvas(e);return r&&r.toDataURL(n.screenshotFormat,n.screenshotQuality)},t.prototype.getCanvas=function(e){var t=this.state,n=this.props;if(!this.video||!t.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var r=this.video.videoWidth,i=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var a=r/i;i=(r=n.minScreenshotWidth||this.video.clientWidth)/a,n.minScreenshotHeight&&i<n.minScreenshotHeight&&(r=(i=n.minScreenshotHeight)*a)}this.canvas=document.createElement("canvas"),this.canvas.width=(null==e?void 0:e.width)||r,this.canvas.height=(null==e?void 0:e.height)||i,this.ctx=this.canvas.getContext("2d")}var o=this.ctx,s=this.canvas;return o&&s&&(n.mirrored&&(o.translate(s.width,0),o.scale(-1,1)),o.imageSmoothingEnabled=n.imageSmoothing,o.drawImage(this.video,0,0,(null==e?void 0:e.width)||s.width,(null==e?void 0:e.height)||s.height),n.mirrored&&(o.scale(-1,1),o.translate(-s.width,0))),s},t.prototype.requestUserMedia=function(){var e=this,n=this.props,r=function(r,i){var a={video:void 0===i||i};n.audio&&(a.audio=void 0===r||r),e.requestUserMediaId++;var o=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(a).then(function(n){e.unmounted||o!==e.requestUserMediaId?t.stopMediaStream(n):e.handleUserMedia(null,n)}).catch(function(t){e.handleUserMedia(t)})};if("mediaDevices"in navigator)r(n.audioConstraints,n.videoConstraints);else{var i=function(e){return{optional:[{sourceId:e}]}},a=function(e){var t=e.deviceId;return"string"==typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"==typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources(function(e){var t=null,o=null;e.forEach(function(e){"audio"===e.kind?t=e.id:"video"===e.kind&&(o=e.id)});var s=a(n.audioConstraints);s&&(t=s);var c=a(n.videoConstraints);c&&(o=c),r(i(t),i(o))})}},t.prototype.handleUserMedia=function(e,t){var n=this.props;if(e||!t){this.setState({hasUserMedia:!1}),n.onUserMediaError(e);return}this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch(r){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}n.onUserMedia(t)},t.prototype.render=function(){var e=this,t=this.state,n=this.props,r=n.audio,a=(n.forceScreenshotSourceSize,n.onUserMedia,n.onUserMediaError,n.screenshotFormat,n.screenshotQuality,n.minScreenshotWidth,n.minScreenshotHeight,n.audioConstraints,n.videoConstraints,n.imageSmoothing,n.mirrored),c=n.style,d=void 0===c?{}:c,l=n.children,u=s(n,["audio","forceScreenshotSourceSize","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),h=a?o(o({},d),{transform:(d.transform||"")+" scaleX(-1)"}):d,f={getScreenshot:this.getScreenshot.bind(this)};return i.createElement(i.Fragment,null,i.createElement("video",o({autoPlay:!0,src:t.src,muted:!r,playsInline:!0,ref:function(t){e.video=t},style:h},u)),l&&l(f))},t.defaultProps={audio:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},t}(i.Component);t.default=d},react:function(e,t){e.exports=r}}).default)},4902:function(){},522:function(){},753:function(){}},function(e){e.O(0,[269,975,774,888,179],function(){return e(e.s=1244)}),_N_E=e.O()}]);